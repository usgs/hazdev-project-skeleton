hazdev-project-skeleton
==============

Project skeleton for hazdev web applications.



## Generating a new Project

- Create an empty GitHub/GitLab/... repository
- Clone this project
  - update the readme, and any other contents.
  - commit changes
- Add empty repository as remote
- Push project to empty repository
- Update remotes and/or reclone from new repository location.


## Using the Generated Project

- Environment is defined in `.env`

- Apache configuration is generated by `src/lib/pre-install`

- Files in `src/htdocs` are available at MOUNT_PATH.

- Files in `etc`, `example`, and `test` are available at the site root,
e.g. `/etc`, `/example`, and `/test`

- PHP files in the `src/htdocs` directory can be requested at MOUNT_PATH

- SCSS files (`*.scss`, `!_*.scss`) in the `src/htdocs/css` directory are compiled.
  Non-entrypoint SCSS files should be named with a leading underscore, or be placed in sub-directories

- JS files (`*.js`) in the `src/htdocs/js` directory are compiled.
  Non-entrypoint files should be placed in sub-directories.


### Run dev environment
> On linux systems a bash script `dev.sh` is provided

- do initial build (required first time, or when apache configuration changes)
```
docker-compose run --rm grunt /bin/bash --login -c "grunt build"
```

- run dev environment
```
docker-compose up
```

- open web browser, the url appears in docker-compose output similar to:
```
httpd_1  | Starting httpd on http://127.0.0.1:8000/mount/path
```

### Build production container
> On linux systems a bash script `dist.sh` is provided

- do dist build
```
docker-compose run --rm grunt /bin/bash --login -c "grunt builddist"
```

- build image
```
docker build -t usgs/hazdev-project-skeleton:latest --build-arg APP_NAME=hazdev-project-skeleton .
```

- run container
```
docker run --rm -p 8000:80 --env-file .env usgs/hazdev-project-skeleton:latest
```
